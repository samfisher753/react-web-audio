(this["webpackJsonpreact-web-audio"]=this["webpackJsonpreact-web-audio"]||[]).push([[0],{69:function(e,t,a){"use strict";a.r(t);var n=a(2),s=a(0),i=a.n(s),r=a(17),o=a.n(r),p=a(59),l=a(10),c=a(11),d=a(8),h=a(14),u=a(13),b=a(81),j=a(83),g=a(80),v={channels:[{id:0,url:"./samples/Kick-Drum-16.wav",sources:[{id:0},{id:8},{id:16},{id:24},{id:32},{id:40},{id:48},{id:56}],gain:.5},{id:1,url:"./samples/Korg-N1R-Snare-Drum-2.wav",sources:[{id:4},{id:12},{id:20},{id:28},{id:36},{id:44},{id:46},{id:52},{id:60},{id:62},{id:63}],gain:.5},{id:2,url:"./samples/Closed-Hi-Hat-1.wav",sources:[{id:0},{id:2},{id:4},{id:6},{id:8},{id:10},{id:12},{id:14},{id:16},{id:18},{id:20},{id:22},{id:24},{id:26},{id:28},{id:30},{id:32},{id:34},{id:36},{id:38},{id:40},{id:42},{id:44},{id:46},{id:48},{id:50},{id:52},{id:54},{id:56},{id:58},{id:60},{id:62}],gain:.5},{id:3,url:"./samples/Alesis-Fusion-Acoustic-Bass-C2.wav",sources:[{id:0},{id:16},{id:32},{id:48}],gain:.5}],masterGain:.5,channelNum:4,bars:4,bpm:85,tc:16,loop:!1,loopTimes:0,filetype:"wav",startBar:1,endBar:4},m=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).showFileChooser=n.showFileChooser.bind(Object(d.a)(n)),n.readFile=n.readFile.bind(Object(d.a)(n)),n.loadExampleProject=n.loadExampleProject.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"showFileChooser",value:function(){this.refs.load.click()}},{key:"readFile",value:function(e){var t=this,a=e.target.files;if(1===a.length){var n=a[0],s=new FileReader;s.onload=function(e){try{var a=JSON.parse(e.target.result);t.props.load(a),t.refs.load.value=""}catch(n){alert("Exception when trying to parse json: "+n)}},s.readAsText(n)}}},{key:"loadExampleProject",value:function(){this.props.load(v)}},{key:"render",value:function(){return Object(n.jsxs)(b.a,{bg:"dark",variant:"dark",expand:"lg",children:[Object(n.jsx)(b.a.Brand,{href:"#",children:"React Sequencer"}),Object(n.jsx)(b.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(n.jsx)(b.a.Collapse,{id:"basic-navbar-nav",children:Object(n.jsxs)(j.a,{className:"mr-auto",children:[Object(n.jsx)("input",{type:"file",ref:"load",style:{display:"none"},onChange:this.readFile,accept:".json"}),Object(n.jsxs)(g.a,{title:"File",id:"basic-nav-dropdown",children:[Object(n.jsx)(g.a.Item,{onClick:this.props.new.bind(null),children:"New"}),Object(n.jsx)(g.a.Item,{onClick:this.showFileChooser,children:"Load"}),Object(n.jsx)(g.a.Item,{onClick:this.props.save.bind(null),children:"Save"})]}),Object(n.jsx)(j.a.Link,{onClick:this.loadExampleProject,children:"Load example project"})]})})]})}}]),a}(i.a.Component),x=a(76),y=a(77),O=a(78),f=a(79),S=a(58),w=a(74),C=a(84),k=function(){function e(t,a,n,s){Object(l.a)(this,e),this.context=t,this.url=a,this.channelId=n,this.onload=s,this.load=this.load.bind(this)}return Object(c.a)(e,[{key:"load",value:function(){var e=new XMLHttpRequest;e.open("GET",this.url,!0),e.responseType="arraybuffer";var t=this;e.onload=function(){t.context.decodeAudioData(e.response,(function(e){e?t.onload(t.channelId,e):alert("error decoding file data: "+t.url)}),(function(e){console.error("decodeAudioData error",e)}))},e.onerror=function(){alert("BufferLoader: XHR error")},e.send()}}]),e}(),B=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).loadAndPlay=n.loadAndPlay.bind(Object(d.a)(n)),n.play=n.play.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"loadAndPlay",value:function(e){var t=this.props.appState.context;new k(t,this.props.url,-1,this.play).load()}},{key:"play",value:function(e,t){var a=this.props.appState.context,n=this.props.appState.sampleSource,s=this.props.gainNode;null!==n&&(n.stop(0),n.disconnect()),(n=a.createBufferSource()).buffer=t,n.connect(s);var i=a.currentTime;this.props.setAppState({sampleSource:n}),n.start(i)}},{key:"render",value:function(){var e=this.props.url.split("/"),t=e[e.length-1];return Object(n.jsxs)(C.a,{style:{fontSize:"12px",margin:"0px",marginBottom:"7px",display:"block"},children:[Object(n.jsx)(S.a,{variant:"secondary",style:{padding:"3px",width:"50px"},onClick:this.loadAndPlay.bind(null,this.props.url),children:"Play"})," ",t,Object(n.jsx)(S.a,{variant:"secondary",style:{padding:"3px",float:"right",width:"50px"},onClick:this.props.addChannel.bind(null,this.props.url),children:"Add"})]})}}]),a}(i.a.Component),A=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).gainNode=e.appState.context.createGain(),n.gainNode.gain.value=.25,n.gainNode.connect(e.appState.context.destination),n}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return Object(n.jsxs)(w.a,{style:{padding:"10px"},children:[Object(n.jsx)("h3",{style:{textAlign:"center"},children:"Samples List"}),this.props.appState.samples.map((function(t,a){return Object(n.jsx)(B,{url:t,appState:e.props.appState,setAppState:e.props.setAppState,addChannel:e.props.addChannel,gainNode:e.gainNode},a)}))]})}}]),a}(i.a.Component),T=a(75),L=a(82),R=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).onChange=n.onChange.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"onChange",value:function(e){e.target.checked?this.props.addBeat(this.props.id,parseInt(e.target.id)):this.props.removeBeat(this.props.id,parseInt(e.target.id))}},{key:"buildRow",value:function(e){for(var t=this.props.tc,a=this.props.sources,s=[],i=0,r=0,o=0;o<e*(t/4);++o){for(var p=0;p<4;++p){for(var l=!1,c=0;c<a.length;++c)if(a[c].id===i){l=!0;break}s.push(Object(n.jsx)("input",{id:i++,type:"checkbox",onChange:this.onChange,checked:l},r++))}i%t===0?s.push(Object(n.jsx)("span",{children:"\xa0\xa0\xa0"},r++)):s.push(Object(n.jsx)("span",{children:"\xa0"},r++))}return s}},{key:"render",value:function(){var e=this.props.url.split("/"),t=e[e.length-1].split("."),a=Object(n.jsx)(T.a,{id:"tooltip",children:Object(n.jsx)("strong",{children:t[0]})});return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{style:{width:"40px",textAlign:"right",paddingRight:"6px"},children:Object(n.jsx)(L.a,{placement:"left",overlay:a,children:Object(n.jsx)("div",{style:{fontWeight:"bold",width:"100px",display:"inline"},children:Object(n.jsxs)("span",{children:[this.props.id,"  - "]})})})}),Object(n.jsx)("td",{children:this.buildRow(this.props.bars)})]})}}]),a}(i.a.Component),N=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{style:{minHeight:"160px",overflow:"auto",whiteSpace:"nowrap"},children:[Object(n.jsx)("h4",{children:"Beats Grid"}),Object(n.jsx)("table",{children:Object(n.jsx)("tbody",{children:0===this.props.channels.length?Object(n.jsx)("tr",{children:Object(n.jsx)("td",{children:Object(n.jsx)("span",{style:{marginLeft:"20px",fontStyle:"italic"},children:'- No sounds were added yet. Add some new sounds, use the "Add sounds" button below.'})})}):this.props.channels.map((function(t){return Object(n.jsx)(R,{bars:e.props.bars,tc:e.props.tc,url:t.url,id:t.id,sources:t.sources,addBeat:e.props.addBeat,removeBeat:e.props.removeBeat},t.id)}))})})]})}}]),a}(i.a.Component),F=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).onChange=n.onChange.bind(Object(d.a)(n)),n.deleteChannel=n.deleteChannel.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"onChange",value:function(e){this.props.gainNode.gain.value=parseFloat(e.target.value),this.props.updateState(this.props.id)}},{key:"deleteChannel",value:function(){this.props.deleteChannel(this.props.id)}},{key:"render",value:function(){var e="Channel "+this.props.id,t={width:"90px",height:"230px",textAlign:"center",borderStyle:"solid",borderWidth:"1px",padding:"5px",float:"left",marginRight:"5px",marginBottom:"4px"};return-1===this.props.id&&(t={width:"90px",height:"230px",textAlign:"center",borderStyle:"solid",borderWidth:"1px",padding:"5px",float:"right",marginRight:"70px",marginBottom:"4px"}),Object(n.jsxs)("div",{style:t,children:[Object(n.jsx)("div",{style:{marginTop:"5px",marginBottom:"10px"},children:-1!==this.props.id?e:"Master"}),Object(n.jsx)("center",{children:-1!==this.props.id?Object(n.jsx)("input",{onChange:this.onChange,type:"range",min:"0.000",max:"1.000",step:"0.001",value:this.props.gainNode.gain.value,style:{width:"30px",WebkitAppearance:"slider-vertical"}}):Object(n.jsx)("input",{onChange:this.onChange,type:"range",min:"0.000",max:"1.000",step:"0.001",value:this.props.gainNode.gain.value,style:{width:"30px",height:"165px",WebkitAppearance:"slider-vertical"}})}),-1!==this.props.id&&Object(n.jsx)("center",{children:Object(n.jsx)(S.a,{variant:"secondary",style:{marginTop:"3px"},onClick:this.deleteChannel,children:"Delete"})})]})}}]),a}(i.a.Component),P=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).updateState=n.updateState.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"updateState",value:function(e){-1===e?this.props.setAppState({master:this.props.master}):this.props.setAppState({channels:this.props.channels})}},{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{style:{display:"inline-block",width:"100%",minHeight:"250px",marginTop:"5px"},children:[Object(n.jsx)("h4",{children:"Mixer"}),Object(n.jsxs)("div",{style:{display:"block"},children:[0===this.props.channels.length?Object(n.jsx)("span",{style:{marginLeft:"20px",fontStyle:"italic"},children:'- No sounds were added yet. Add some new sounds, use the "Add sounds" button below.'}):this.props.channels.map((function(t){return Object(n.jsx)(F,{id:t.id,gainNode:t.gainNode,deleteChannel:e.props.deleteChannel,updateState:e.updateState},t.id)})),Object(n.jsx)(F,{id:-1,gainNode:this.props.master,updateState:this.updateState})]})]})}}]),a}(i.a.Component),E=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).changeFileType=n.changeFileType.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"changeFileType",value:function(e){this.props.changeFileType(e.target.value)}},{key:"render",value:function(){var e="secondary",t=e;this.props.playing&&(t="success");var a=e;return this.props.recording&&(a="danger"),Object(n.jsxs)("div",{style:{marginTop:"20px",minHeight:"80px"},children:[Object(n.jsx)("h4",{children:"Control Bar"}),Object(n.jsx)(S.a,{onClick:this.props.play,variant:t,style:{marginRight:"5px"},children:"Play"}),Object(n.jsx)(S.a,{variant:e,onClick:this.props.stop,children:"Stop"}),Object(n.jsx)(S.a,{variant:e,onClick:this.props.showSamplesList,style:{marginLeft:"20px",marginRight:"15px"},children:"Add sounds"}),"File type:",Object(n.jsxs)("select",{style:{marginLeft:"5px",marginRight:"10px"},onChange:this.changeFileType,value:this.props.filetype,children:[Object(n.jsx)("option",{value:"wav",children:"WAV 16 bits"}),Object(n.jsx)("option",{value:"mp3",children:"MP3 320 kbps"}),Object(n.jsx)("option",{value:"ogg",children:"OGG"})]}),Object(n.jsx)(S.a,{onClick:this.props.record,variant:a,children:"Record"})]})}}]),a}(i.a.Component),H=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).changeBars=n.changeBars.bind(Object(d.a)(n)),n.changeBPM=n.changeBPM.bind(Object(d.a)(n)),n.changeTC=n.changeTC.bind(Object(d.a)(n)),n.addBeat=n.addBeat.bind(Object(d.a)(n)),n.removeBeat=n.removeBeat.bind(Object(d.a)(n)),n.play=n.play.bind(Object(d.a)(n)),n.stop=n.stop.bind(Object(d.a)(n)),n.record=n.record.bind(Object(d.a)(n)),n.onChangeLoop=n.onChangeLoop.bind(Object(d.a)(n)),n.changeLoopTimes=n.changeLoopTimes.bind(Object(d.a)(n)),n.changeFileType=n.changeFileType.bind(Object(d.a)(n)),n.endPlayHandler=n.endPlayHandler.bind(Object(d.a)(n)),n.changeStartBar=n.changeStartBar.bind(Object(d.a)(n)),n.changeEndBar=n.changeEndBar.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"changeBars",value:function(e){var t=this.props.appState.bars,a=parseInt(e.target.value),n=this.props.appState.channels;if(a<t)for(var s=a*this.props.appState.tc,i=0;i<n.length;++i)for(var r=n[i].sources,o=0;o<r.length;++o)r[o].id>=s&&(null!==r[o].source&&(r[o].source.stop(0),r[o].source.disconnect()),r.splice(o--,1));var p=this.props.appState.endBar;a<p&&(p=a);var l=this.props.appState.startBar;l>p&&(l=p),this.props.setAppState({channels:n,bars:a,startBar:l,endBar:p})}},{key:"changeBPM",value:function(e){this.props.setAppState({bpm:parseFloat(e.target.value)})}},{key:"changeTC",value:function(e){this.props.stopAllSources();for(var t=this.props.appState.channels,a=0;a<t.length;++a)t[a].sources=[];this.props.setAppState({channels:t,tc:parseInt(e.target.value)})}},{key:"addBeat",value:function(e,t){for(var a=this.props.appState.channels,n=0;a[n].id!==e;)++n;for(var s=0;s<a[n].sources.length&&a[n].sources[s].id<t;)++s;a[n].sources.splice(s,0,{id:t,source:null}),this.props.setAppState({channels:a})}},{key:"removeBeat",value:function(e,t){for(var a=this.props.appState.channels,n=0;a[n].id!==e;)++n;for(var s=0;a[n].sources[s].id!==t;)++s;a[n].sources.splice(s,1),this.props.setAppState({channels:a})}},{key:"play",value:function(){var e=this,t=this.props.appState;!t.playing&&!t.loading&&t.channels.length>0&&this.props.setAppState({playing:!0},(function(){for(var a=t.context,n=t.channels,s=a.currentTime,i=t.bpm,r=t.tc,o=240/(i*r),p=(t.startBar-1)*r,l=t.endBar*r,c=p*o,d=0;d<n.length;++d){for(var h=n[d].buffer,u=n[d].sources,b=n[d].gainNode,j=0;j<u.length&&u[j].id<p;)++j;for(;j<u.length&&u[j].id<l;){var g=a.createBufferSource();g.buffer=h,g.connect(b);var v=s+u[j].id*o-c;u[j].source=g,g.start(v),++j}}var m=240/i*(t.endBar-t.startBar+1)*1e3,x=setTimeout((function(){e.endPlayHandler()}),m);e.props.setAppState({channels:n,timeout:x})}))}},{key:"endPlayHandler",value:function(){var e=this.props.appState;e.loop?0!==e.loopTimes?e.loopCount<e.loopTimes?this.props.setAppState({loopCount:this.props.appState.loopCount+1,playing:!1},this.play):this.props.setAppState({playing:!1,loopCount:1}):e.recording?this.props.setAppState({playing:!1}):this.props.setAppState({playing:!1},this.play):this.props.setAppState({playing:!1})}},{key:"stop",value:function(){this.props.appState.playing&&(this.props.appState.recorder.isRecording()&&this.props.appState.recorder.cancelRecording(),clearTimeout(this.props.appState.timeout),this.props.stopAllSources(),this.props.setAppState({recording:!1,playing:!1,loopCount:1}))}},{key:"record",value:function(){var e=this,t=this.props.appState;if(!t.recording&&!t.loading&&t.channels.length>0){var a=t.endBar-t.startBar+1,n=t.bpm,s=t.recorder,i=240*a/n;t.loop&&0!==t.loopTimes&&(i=240*a/n*t.loopTimes);var r=t.filetype;s.setOptions({timeLimit:i}),s.onComplete=function(t,a){window.download(a,"mixdown."+r),e.props.setAppState({recording:!1})},this.props.setAppState({recording:!0},(function(){s.startRecording(),e.play()}))}}},{key:"onChangeLoop",value:function(e){e.target.checked?this.props.setAppState({loop:e.target.checked}):this.props.setAppState({loop:e.target.checked,loopTimes:0,loopCount:1})}},{key:"changeLoopTimes",value:function(e){this.props.setAppState({loopTimes:parseInt(e.target.value)})}},{key:"changeStartBar",value:function(e){var t=parseInt(e.target.value);this.props.setAppState({startBar:t})}},{key:"changeEndBar",value:function(e){var t=parseInt(e.target.value);this.props.setAppState({endBar:t})}},{key:"changeFileType",value:function(e){var t=this.props.appState.recorder;t.isRecording()||(t.setEncoding(e),this.props.setAppState({filetype:e}))}},{key:"render",value:function(){var e=this.props.appState;return Object(n.jsxs)(w.a,{style:{padding:"10px 30px",paddingBottom:"30px"},children:[Object(n.jsx)("h3",{children:"Audio Editor"}),Object(n.jsxs)("h5",{style:{marginTop:"20px",marginLeft:"25px"},children:["Bars: ",Object(n.jsx)("input",{type:"number",min:"1",value:e.bars,onChange:this.changeBars,style:{width:"50px",textAlign:"center",marginRight:"10px"}}),"BPM: ",Object(n.jsx)("input",{type:"number",min:"0",value:e.bpm,onChange:this.changeBPM,style:{width:"60px",textAlign:"center",marginRight:"10px"}}),"Time Correct:",Object(n.jsxs)("select",{value:e.tc,onChange:this.changeTC,style:{width:"50px",marginLeft:"5px",marginRight:"10px"},children:[Object(n.jsx)("option",{value:"4",children:"4"}),Object(n.jsx)("option",{value:"8",children:"8"}),Object(n.jsx)("option",{value:"16",children:"16"}),Object(n.jsx)("option",{value:"32",children:"32"}),Object(n.jsx)("option",{value:"64",children:"64"})]}),"Loop: ",Object(n.jsx)("input",{type:"checkbox",onChange:this.onChangeLoop,checked:e.loop,style:{marginRight:"10px"}}),"Times: ",Object(n.jsx)("input",{type:"number",min:"0",value:e.loopTimes,onChange:this.changeLoopTimes,disabled:!e.loop,style:{width:"50px",textAlign:"center"}})," ",Object(n.jsx)("small",{children:"(0 infinite)"})]}),Object(n.jsxs)("h5",{style:{marginLeft:"25px"},children:["Initial bar: ",Object(n.jsx)("input",{type:"number",min:"1",max:e.endBar,value:e.startBar,onChange:this.changeStartBar,style:{width:"50px",textAlign:"center",marginRight:"10px"}}),"Ending bar: ",Object(n.jsx)("input",{type:"number",min:e.startBar,max:e.bars,value:e.endBar,onChange:this.changeEndBar,style:{width:"50px",textAlign:"center",marginRight:"10px"}})]}),Object(n.jsx)(N,{bars:e.bars,tc:e.tc,channels:e.channels,addBeat:this.addBeat,removeBeat:this.removeBeat}),Object(n.jsx)(P,{channels:e.channels,master:e.master,deleteChannel:this.props.deleteChannel,setAppState:this.props.setAppState}),Object(n.jsx)(E,{play:this.play,stop:this.stop,record:this.record,playing:e.playing,recording:e.recording,filetype:e.filetype,changeFileType:this.changeFileType,showSamplesList:this.props.showSamplesList})]})}}]),a}(i.a.Component),K=["./samples/Kick-Drum-16.wav","./samples/Dry-Kick.wav","./samples/E-Mu-Proteus-FX-909-Kick.wav","./samples/Ensoniq-SQ-1-Rock-Kick.wav","./samples/Kawai-K11-Bob-Kick.wav","./samples/Bass-Drum-1.wav","./samples/Bass-Drum-2.wav","./samples/Bass-Drum-3.wav","./samples/Kawai-K1r-Rap-Kick.wav","./samples/Kick-Drum-11.wav","./samples/Kick-Drum-12.wav","./samples/Kick-Drum-13.wav","./samples/Kick-Drum-17.wav","./samples/Kick-Drum-18.wav","./samples/Korg-N1R-Snare-Drum-2.wav","./samples/Ensoniq-SQ-1-Rock-Snare.wav","./samples/Hip-Hop-Snare-1.wav","./samples/E-Mu-Proteus-FX-Wacky-Snare.wav","./samples/Ensoniq-ESQ-1-Snare.wav","./samples/Korg-M3R-Snare.wav","./samples/Closed-Hi-Hat-1.wav","./samples/Closed-Hi-Hat-2.wav","./samples/Closed-Hi-Hat-3.wav","./samples/1980s-Casio-Piano-C5.wav","./samples/Alesis-Fusion-Acoustic-Bass-C2.wav","./samples/Electro-Tom.wav"],D=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a),e=t.call(this),window.AudioContext=window.AudioContext||window.webKitAudioContext;var n=new AudioContext,s=n.createGain();s.gain.value=.5,s.connect(n.destination);var i=new window.WebAudioRecorder(s,{workerDir:"../lib/",options:{ogg:{quality:1},mp3:{bitRate:320}}});return e.state={context:n,channels:[],master:s,showSamplesList:!1,recorder:i,channelNum:0,loading:!1,sampleSource:null,samples:K,playing:!1,recording:!1,bars:4,bpm:85,tc:16,loop:!1,loopTimes:0,loopCount:1,filetype:"wav",startBar:1,endBar:4},e.addChannel=e.addChannel.bind(Object(d.a)(e)),e.deleteChannel=e.deleteChannel.bind(Object(d.a)(e)),e.bufferLoaded=e.bufferLoaded.bind(Object(d.a)(e)),e.setState=e.setState.bind(Object(d.a)(e)),e.disconnectAll=e.disconnectAll.bind(Object(d.a)(e)),e.stopAllSources=e.stopAllSources.bind(Object(d.a)(e)),e.showSamplesList=e.showSamplesList.bind(Object(d.a)(e)),e.hideSamplesList=e.hideSamplesList.bind(Object(d.a)(e)),e.appReset=e.appReset.bind(Object(d.a)(e)),e.load=e.load.bind(Object(d.a)(e)),e.save=e.save.bind(Object(d.a)(e)),e}return Object(c.a)(a,[{key:"appReset",value:function(){this.state.playing&&clearTimeout(this.state.timeout),this.stopAllSources(),null!==this.state.sampleSource&&(this.state.sampleSource.stop(0),this.state.sampleSource.disconnect()),this.disconnectAll();var e=this.state.master;e.gain.value=.5,this.setState({channels:[],master:e,showSamplesList:!1,channelNum:0,loading:!1,sampleSource:null,playing:!1,recording:!1,bars:4,bpm:85,tc:16,loop:!1,loopTimes:0,loopCount:1,filetype:"wav",startBar:1,endBar:4})}},{key:"disconnectAll",value:function(){for(var e=this.state.channels,t=0;t<e.length;++t)e[t].gainNode.disconnect()}},{key:"addChannel",value:function(e){var t=this.state.context,a=t.createGain(),n=this.state.master,s=this.state.channelNum;a.connect(n),a.gain.value=.5;var i=[].concat(Object(p.a)(this.state.channels),[{id:s,url:e,beats:[],gainNode:a,sources:[]}]);this.setState({channels:i,channelNum:this.state.channelNum+1,loading:!0}),new k(t,e,s,this.bufferLoaded).load()}},{key:"deleteChannel",value:function(e){for(var t=this.state.channels,a=0;a<t.length;++a)if(t[a].id===e){t.splice(a,1);break}this.setState({channels:t})}},{key:"bufferLoaded",value:function(e,t){for(var a=this.state.channels,n=0;n<a.length;++n)if(a[n].id===e){a[n].buffer=t;break}this.setState({channels:a,loading:!1})}},{key:"stopAllSources",value:function(){for(var e=this.state.channels,t=0;t<e.length;++t)for(var a=e[t].sources,n=0;n<a.length;++n)null!==a[n].source&&(a[n].source.stop(0),a[n].source.disconnect(),a[n].source=null)}},{key:"showSamplesList",value:function(){this.setState({showSamplesList:!0})}},{key:"hideSamplesList",value:function(){this.setState({showSamplesList:!1})}},{key:"load",value:function(e){this.appReset();var t=[],a=this.state.context,n=this.state.master;n.gain.value=e.masterGain;for(var s=0;s<e.channels.length;++s){for(var i=e.channels[s],r=e.channels[s].sources,o=[],p=0;p<r.length;++p)o.push({id:r[p].id,source:null});var l=a.createGain();l.connect(n),l.gain.value=i.gain,t.push({id:i.id,gainNode:l,sources:o,url:i.url})}this.setState({channels:t,master:n,channelNum:e.channelNum,bars:e.bars,bpm:e.bpm,tc:e.tc,loop:e.loop,loopTimes:e.loopTimes,filetype:e.filetype,loading:!0,startBar:e.startBar,endBar:e.endBar});for(var c=0;c<t.length;++c){var d=t[c];new k(a,d.url,d.id,this.bufferLoaded).load()}}},{key:"save",value:function(){for(var e=this.state,t=[],a=0;a<e.channels.length;++a){for(var n=e.channels[a].sources,s=[],i=0;i<n.length;++i){var r=e.channels[a].sources[i];s.push({id:r.id})}t.push({id:e.channels[a].id,url:e.channels[a].url,sources:s,gain:e.channels[a].gainNode.gain.value})}var o={channels:t,masterGain:e.master.gain.value,channelNum:e.channelNum,bars:e.bars,bpm:e.bpm,tc:e.tc,loop:e.loop,loopTimes:e.loopTimes,filetype:e.filetype,startBar:e.startBar,endBar:e.endBar};window.download(JSON.stringify(o,null,2),"MyProject.json")}},{key:"render",value:function(){return Object(n.jsxs)("div",{children:[Object(n.jsx)(m,{new:this.appReset,load:this.load,save:this.save}),Object(n.jsx)(x.a,{style:{marginTop:"25px"},children:Object(n.jsx)(y.a,{children:Object(n.jsx)(O.a,{children:Object(n.jsx)(H,{appState:this.state,setAppState:this.setState,stopAllSources:this.stopAllSources,showSamplesList:this.showSamplesList,deleteChannel:this.deleteChannel})})})}),Object(n.jsxs)(f.a,{show:this.state.showSamplesList,onHide:this.hideSamplesList,children:[Object(n.jsx)(f.a.Header,{closeButton:!0,children:Object(n.jsx)(f.a.Title,{children:"Select the samples you want to use"})}),Object(n.jsx)(f.a.Body,{children:Object(n.jsx)(A,{appState:this.state,setAppState:this.setState,addChannel:this.addChannel})}),Object(n.jsx)(f.a.Footer,{children:Object(n.jsx)(S.a,{variant:"secondary",onClick:this.hideSamplesList,children:"Close"})})]})]})}}]),a}(i.a.Component);o.a.render(Object(n.jsx)(D,{}),document.getElementById("app"))}},[[69,1,2]]]);
//# sourceMappingURL=main.7b2f8f73.chunk.js.map